(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     15176,        449]
NotebookOptionsPosition[     14533,        425]
NotebookOutlinePosition[     14954,        441]
CellTagsIndexPosition[     14911,        438]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ElectrostaticLine", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xa_", ",", "ya_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xb_", ",", "yb_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xc_", ",", "yc_"}], "}"}]}], "}"}], ",", "l_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "b", ",", "c", ",", "u", ",", "v", ",", "w", ",", "dx", ",", 
      "dy", ",", "nx", ",", "ny"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xc", ",", "yc"}], "}"}], "-", 
        RowBox[{"{", 
         RowBox[{"xb", ",", "yb"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xa", ",", "ya"}], "}"}], "-", 
        RowBox[{"{", 
         RowBox[{"xc", ",", "yc"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"c", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xb", ",", "yb"}], "}"}], "-", 
        RowBox[{"{", 
         RowBox[{"xa", ",", "ya"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"a", "*", 
       RowBox[{"Coth", "[", 
        FractionBox[
         RowBox[{"a", "*", "l"}], 
         RowBox[{"a", "+", "b", "+", "c"}]], "]"}]}]}], ";", 
     RowBox[{"v", "=", 
      RowBox[{"b", "*", 
       RowBox[{"Coth", "[", 
        FractionBox[
         RowBox[{"b", "*", "l"}], 
         RowBox[{"a", "+", "b", "+", "c"}]], "]"}]}]}], ";", 
     RowBox[{"w", "=", 
      RowBox[{"c", "*", 
       RowBox[{"Coth", "[", 
        FractionBox[
         RowBox[{"c", "*", "l"}], 
         RowBox[{"a", "+", "b", "+", "c"}]], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dx", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["xa", "2"], "+", 
          SuperscriptBox["ya", "2"], "-", 
          RowBox[{"v", "*", "w"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"yb", "-", "yc"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["xb", "2"], "+", 
          SuperscriptBox["yb", "2"], "-", 
          RowBox[{"w", "*", "u"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"yc", "-", "ya"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["xc", "2"], "+", 
          SuperscriptBox["yc", "2"], "-", 
          RowBox[{"u", "*", "v"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"ya", "-", "yb"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nx", "=", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xa", 
          RowBox[{"(", 
           RowBox[{"yb", "-", "yc"}], ")"}]}], "+", 
         RowBox[{"xb", 
          RowBox[{"(", 
           RowBox[{"yc", "-", "ya"}], ")"}]}], "+", 
         RowBox[{"xc", 
          RowBox[{"(", 
           RowBox[{"ya", "-", "yb"}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dy", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["xa", "2"], "+", 
          SuperscriptBox["ya", "2"], "-", 
          RowBox[{"v", "*", "w"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"xb", "-", "xc"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["xb", "2"], "+", 
          SuperscriptBox["yb", "2"], "-", 
          RowBox[{"w", "*", "u"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"xc", "-", "xa"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["xc", "2"], "+", 
          SuperscriptBox["yc", "2"], "-", 
          RowBox[{"u", "*", "v"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"xa", "-", "xb"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ny", "=", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ya", 
          RowBox[{"(", 
           RowBox[{"xb", "-", "xc"}], ")"}]}], "+", 
         RowBox[{"yb", 
          RowBox[{"(", 
           RowBox[{"xc", "-", "xa"}], ")"}]}], "+", 
         RowBox[{"yc", 
          RowBox[{"(", 
           RowBox[{"xa", "-", "xb"}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dx", "/", "nx"}], ",", 
        RowBox[{"dy", "/", "ny"}]}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.591811528136894*^9, 3.5918116843748302`*^9}, {
   3.59181185028932*^9, 3.5918120386500936`*^9}, {3.5918124004747887`*^9, 
   3.5918124219210157`*^9}, {3.591845453416309*^9, 3.5918454738584785`*^9}, {
   3.592054598946574*^9, 3.592054601511721*^9}, {3.592055640080124*^9, 
   3.592055641678215*^9}, {3.592131741767891*^9, 3.592131753135542*^9}, {
   3.5924076515*^9, 3.592407671140625*^9}, {3.596196757110673*^9, 
   3.596196765818171*^9}, {3.596196797400977*^9, 3.5961968072695417`*^9}, {
   3.596277744066862*^9, 3.596277773461543*^9}, {3.615437980381624*^9, 
   3.615437994875453*^9}, {3.615438271217259*^9, 3.615438295942673*^9}, {
   3.615438379540455*^9, 3.6154383849067616`*^9}, {3.6154384774180527`*^9, 
   3.615438516512289*^9}, {3.6154389600556583`*^9, 3.6154392112330246`*^9}, 
   3.6154407107337914`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindElectrostaticLambda", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xa_", ",", "ya_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xb_", ",", "yb_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xc_", ",", "yc_"}], "}"}]}], "}"}], ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{"Precision", "\[Rule]", "7"}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "b", ",", "c", ",", "s", ",", "l", ",", "u", ",", "v", ",", 
      "w", ",", "left", ",", "right", ",", "sol", ",", "p"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xc", ",", "yc"}], "}"}], "-", 
        RowBox[{"{", 
         RowBox[{"xb", ",", "yb"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xa", ",", "ya"}], "}"}], "-", 
        RowBox[{"{", 
         RowBox[{"xc", ",", "yc"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"c", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xb", ",", "yb"}], "}"}], "-", 
        RowBox[{"{", 
         RowBox[{"xa", ",", "ya"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"a", "*", 
       RowBox[{"Coth", "[", 
        FractionBox[
         RowBox[{"a", "*", "l"}], 
         RowBox[{"a", "+", "b", "+", "c"}]], "]"}]}]}], ";", 
     RowBox[{"v", "=", 
      RowBox[{"b", "*", 
       RowBox[{"Coth", "[", 
        FractionBox[
         RowBox[{"b", "*", "l"}], 
         RowBox[{"a", "+", "b", "+", "c"}]], "]"}]}]}], ";", 
     RowBox[{"w", "=", 
      RowBox[{"c", "*", 
       RowBox[{"Coth", "[", 
        FractionBox[
         RowBox[{"c", "*", "l"}], 
         RowBox[{"a", "+", "b", "+", "c"}]], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"left", "=", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["u", "2"], "-", 
           SuperscriptBox["a", "2"]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"v", "-", "w"}], ")"}], "2"]}], ")"}]}]], "+", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["v", "2"], "-", 
           SuperscriptBox["b", "2"]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["b", "2"], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"w", "-", "u"}], ")"}], "2"]}], ")"}]}]], "+", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["w", "2"], "-", 
           SuperscriptBox["c", "2"]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["c", "2"], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"u", "-", "v"}], ")"}], "2"]}], ")"}]}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"right", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["a", "2"], 
            SuperscriptBox["b", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["b", "2"], 
            SuperscriptBox["c", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["c", "2"], 
            SuperscriptBox["a", "2"]}]}], ")"}]}], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "4"], "+", 
          SuperscriptBox["b", "4"], "+", 
          SuperscriptBox["c", "4"]}], ")"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"FindRoot", "[", 
       RowBox[{
        RowBox[{"left", "\[Equal]", "right"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1"}], "}"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Precision", "]"}]}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Precision", "]"}]}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Precision", "]"}]}], ",", 
        RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"l", "/.", "sol"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5920543857663813`*^9, 3.592054491065404*^9}, {
   3.59213139277493*^9, 3.592131410058919*^9}, {3.59239762321875*^9, 
   3.592397634578125*^9}, {3.615438257230459*^9, 3.6154382614837027`*^9}, {
   3.615438390871103*^9, 3.6154384185376854`*^9}, {3.615439508384021*^9, 
   3.6154395796020947`*^9}, {3.6154397232473106`*^9, 3.615439726469495*^9}, {
   3.6154397617015095`*^9, 3.615439777244399*^9}, {3.6154404436675158`*^9, 
   3.6154405002277513`*^9}, {3.615440534348703*^9, 3.615440564955453*^9}, {
   3.6154406153673368`*^9, 3.6154406303311925`*^9}, 3.6154407078186245`*^9, {
   3.615440817135877*^9, 3.615440836787001*^9}, {3.615441044834901*^9, 
   3.615441075451652*^9}, {3.615441220212932*^9, 3.6154412240731525`*^9}, {
   3.6154413592658854`*^9, 3.6154413676613655`*^9}, {3.6154414044774714`*^9, 
   3.6154414357342587`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindElectrostaticCenter", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xa_", ",", "ya_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xb_", ",", "yb_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xc_", ",", "yc_"}], "}"}]}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "l", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", "=", 
      RowBox[{"FindElectrostaticLambda", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xa", ",", "ya"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xb", ",", "yb"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xc", ",", "yc"}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"ElectrostaticLine", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xa", ",", "ya"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xb", ",", "yb"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xc", ",", "yc"}], "}"}]}], "}"}], ",", "l"}], "]"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6154386743633175`*^9, 3.6154387560869923`*^9}, 
   3.6154407138399687`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindElectrostaticCenter", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.615439731302771*^9, 3.615439749660821*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.27255790709216159384935214357925003971`6.002318087758951", ",", 
   "0.70414818961553920576280575430172313947`6.2176918185873"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6154397502338543`*^9, 3.6154397793575196`*^9}, 
   3.6154405057030644`*^9, 3.61544054199514*^9, {3.615440622518746*^9, 
   3.615440634988459*^9}, 3.615440840211197*^9, 3.6154412280723815`*^9, 
   3.6154414421866283`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindElectrostaticLambda", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.615440849682739*^9, 3.6154408544170094`*^9}, {
  3.6154412083392525`*^9, 3.615441239390029*^9}}],

Cell[BoxData["4.0102971940252672261737066576060328258`7."], "Output",
 CellChangeTimes->{{3.615440850299774*^9, 3.6154408553740644`*^9}, 
   3.6154410820800314`*^9, {3.6154412127425046`*^9, 3.615441240062067*^9}, {
   3.615441372324632*^9, 3.6154414137650023`*^9}, 3.6154414441857424`*^9}]
}, Open  ]]
},
WindowSize->{1350, 710},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 5508, 158, 248, "Input"],
Cell[6056, 180, 5502, 152, 261, "Input"],
Cell[11561, 334, 1360, 40, 112, "Input"],
Cell[CellGroupData[{
Cell[12946, 378, 374, 11, 31, "Input"],
Cell[13323, 391, 438, 9, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13798, 405, 427, 12, 31, "Input"],
Cell[14228, 419, 289, 3, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
